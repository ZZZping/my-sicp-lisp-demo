#lang sicp
(define (cube x)
   (* x x x));
(define (p x)
  (- (* 3 x) (* 4 (cube x))));
(define (sine x)
  (if (not (> (abs x) 0.1)) x
      (p (sin (/ x 3.0)))));
;;(sin 12.15)
;;12.15 > 0.1
;; (p (sin (/ 12.15 3)))
;;

;;b^n
(define (b_n b n)
  (if (= n 0) 1
      (* b (b_n b (- n 1)))));

(define (b_n_1 b n)
  (exp-iter-b b n 1));
(define (exp-iter-b b counter product)
  (if (= counter 0) product
      (exp-iter-b b (- counter 1) (* b product))));

(define (fast_b_n b n)
  (cond ((= n 0) 1)
        ((even? n) (square (fast_b_n b (/ n 2))))
        (else (* b (fast_b_n b (- n 1))))));
;;判断是否是偶数
(define (even? n)
  (= (remainder n 2) 0));
(define (square n)
  (* n n));

;;1.16
(define (b_n_2 b n)
  (fast-exp-iter-b b n 1))
(define (fast-exp-iter-b b counter product)
  (cond ((= counter 0) product)
        ((even? counter) (fast-exp-iter-b (square b) (/ counter 2) product))
        ( else (fast-exp-iter-b b (- counter 1) (* product b)))));